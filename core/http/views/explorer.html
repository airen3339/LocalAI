<!DOCTYPE html>
<html lang="en">

{{template "views/partials/head" .}}

<style>
    body {
        background-color: #1a202c;
        color: #e2e8f0;
        font-family: Arial, sans-serif;
    }
    .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }
    .network-card {
        background-color: #2d3748;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
    }
    .network-title {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
    }
    .cluster {
        margin-top: 10px;
        background-color: #4a5568;
        padding: 10px;
        border-radius: 6px;
    }
    .cluster-title {
        font-size: 18px;
        font-weight: bold;
    }
</style>
<body class="bg-gray-900 text-gray-200">
    <div class="flex flex-col min-h-screen" x-data="networkClusters()" x-init="init()">
        <header class="text-center py-12">
            <h1 class="text-5xl font-bold text-gray-100">Network Clusters</h1>
            <p class="mt-4 text-lg">View the clusters and workers available in each network.</p>
        </header>

        <div class="container mx-auto px-4 flex-grow">
            <template x-if="networks.length === 0">
                <p class="text-center">Loading networks...</p>
            </template>
    
            <template x-for="network in networks" :key="network.name">
                <div class="network-card">
                    <div class="network-title" x-text="network.name"></div>
                    <div class="network-token" x-text="network.token"></div>
                    <p x-text="network.description"></p>
    
                    <template x-for="cluster in network.Clusters" :key="cluster.NetworkID + cluster.Type">
                        <div class="cluster">
                            <div class="cluster-title" x-text="'Cluster Type: ' + cluster.Type"></div>
                            <p x-text="'Network ID: ' + (cluster.NetworkID || 'N/A')"></p>
                            <p x-text="'Number of Workers: ' + cluster.Workers.length"></p>
                        </div>
                    </template>
                </div>
            </template>
        </div>

        <script>
            function networkClusters() {
                return {
                    networks: [],
    
                    fetchNetworks() {
                        console.log('Fetching networks...');
                        fetch('/networks')
                            .then(response => response.json())
                            .then(data => {
                                console.log('Data fetched successfully:', data);
                                this.networks = data;
                            })
                            .catch(error => {
                                console.error('Error fetching networks:', error);
                            });
                    },
    
                    init() {
                        console.log('Initializing Alpine component...');
                        this.fetchNetworks();
                        setInterval(() => {
                            this.fetchNetworks();
                        }, 5000); // Refresh every 5 seconds
                    }
                }
            }
        </script>

{{template "views/partials/footer" .}}
</div>

</body>
</html>
